# Additional MOPS Crawlers - Requirements

## Feature Description

æ“´å±• MOPS è²¡å ±æœå‹™ï¼Œæ–°å¢ 6 å€‹é‡è¦çš„é XBRL è³‡æ–™çˆ¬èŸ²å’Œå°æ‡‰çš„ API ç«¯é»ã€‚é€™äº›è³‡æ–™ä¾†è‡ª MOPS çš„ HTML è¡¨æ ¼ï¼Œæ˜¯æŠ•è³‡ç ”ç©¶çš„é‡è¦é ˜å…ˆæŒ‡æ¨™å’Œé¢¨æ§æ•¸æ“šã€‚

## New Data Sources

### 1. æœˆç‡Ÿæ”¶ (Monthly Revenue) ğŸ”¥ æœ€é«˜å„ªå…ˆ
**æŠ•è³‡åƒ¹å€¼**: å°è‚¡æœ€é‡è¦çš„é ˜å…ˆæŒ‡æ¨™ï¼Œæ¯æœˆ 10 è™Ÿå…¬å¸ƒï¼Œæ¯”å­£å ±æå‰ 45 å¤©ã€‚

**MOPS è·¯å¾‘**: `ç‡Ÿé‹æ¦‚æ³` > `æ¯æœˆç‡Ÿæ”¶` > `æ¡ç”¨IFRSså¾Œä¹‹æœˆç‡Ÿæ¥­æ”¶å…¥è³‡è¨Š`

**é—œéµæ¬„ä½**:
- æœ¬æœˆç‡Ÿæ”¶ (Revenue)
- å»å¹´åŒæœˆå¢æ¸›ç‡ (YoY%) - å‹•èƒ½ç­–ç•¥æ ¸å¿ƒå› å­
- ä¸Šæœˆæ¯”è¼ƒå¢æ¸›ç‡ (MoM%) - çŸ­æœŸç‡Ÿé‹è½‰æŠ˜
- å‚™è¨» (Comment) - éæ¿¾ä¸€æ¬¡æ€§æ”¶å…¥é›œè¨Š

**æ‡‰ç”¨**: é ä¼°ä¸‹ä¸€å­£ EPS

---

### 2. èƒŒæ›¸ä¿è­‰èˆ‡è³‡é‡‘è²¸èˆ‡ (Endorsements & Lending) âš ï¸ åœ°é›·æŒ‡æ¨™
**æŠ•è³‡åƒ¹å€¼**: å¾ˆå¤šåœ°é›·è‚¡çˆ†ç™¼å‰çš„å‰å…†ï¼ˆä¾‹å¦‚åšé”æ¡ˆï¼‰ï¼Œé€™äº›éŒ¢ä¸æœƒç›´æ¥åˆ—åœ¨è² å‚µï¼Œä½†æœƒåˆ—åœ¨ã€Œæˆ–æœ‰è² å‚µã€ã€‚

**MOPS è·¯å¾‘**: `è²¡å‹™é‡é»å°ˆå€` æˆ– `å„é …å°ˆå€` > `èƒŒæ›¸ä¿è­‰/è³‡é‡‘è²¸èˆ‡`

**é—œéµæ¬„ä½**:
- å°å–®ä¸€ä¼æ¥­èƒŒæ›¸ä¿è­‰é‡‘é¡ - æ˜¯å¦éåº¦é›†ä¸­
- èƒŒæ›¸ä¿è­‰ä½”æ·¨å€¼æ¯”ç‡ - **è¶…é 50% æ¥µåº¦å±éšª**
- è³‡é‡‘è²¸èˆ‡é¤˜é¡ - å€Ÿçµ¦é—œä¿‚äººçš„é‡‘é¡

**æ‡‰ç”¨**: è² é¢ç¯©é¸å™¨ (Negative Filter)ï¼Œå‰”é™¤é¢¨æ§éé«˜çš„å…¬å¸

---

### 3. è‘£ç›£äº‹è³ªæŠ¼ (Share Pledging) âš ï¸ ç±Œç¢¼æ–·é ­é¢¨éšª
**æŠ•è³‡åƒ¹å€¼**: è€é—†æŠŠè‚¡ç¥¨è³ªæŠ¼å€ŸéŒ¢ï¼Œé«˜è³ªæŠ¼æ¯” >50% æ™‚è‚¡åƒ¹ä¸‹è·Œæœƒæœ‰ã€Œè£œç¹³ä¿è­‰é‡‘ã€å£“åŠ›ï¼Œå¯èƒ½è¢«æ–·é ­ã€‚

**MOPS è·¯å¾‘**: `åŸºæœ¬è³‡æ–™` > `è‘£ç›£å¤§è‚¡æ±æŒè‚¡ã€è³ªæŠ¼ã€è½‰è®“`

**é—œéµæ¬„ä½**:
- è³ªæŠ¼å¼µæ•¸
- æŒè‚¡å¼µæ•¸
- è³ªæŠ¼æ¯”ç‡ (%)

**æ‡‰ç”¨**: åšç©ºæŒ‡æ¨™ / é¿å…é¢¨éšª

---

### 4. è‚¡åˆ©åˆ†æ´¾ (Dividend Policy) ğŸ’° çœŸå¯¦æ®–åˆ©ç‡
**æŠ•è³‡åƒ¹å€¼**: è²¡å ±ä¸Šçš„ EPS ä¸ç­‰æ–¼å¯¦éš›æ‹¿åˆ°çš„éŒ¢ï¼Œéœ€è¦çŸ¥é“è‚¡åˆ©æ”¿ç­–ã€‚

**MOPS è·¯å¾‘**: `è‚¡æ±æœƒåŠè‚¡åˆ©` > `é™¤æ¬Šæ¯å…¬å‘Š`

**é—œéµæ¬„ä½**:
- ç¾é‡‘è‚¡åˆ© (Cash Dividend)
- è‚¡ç¥¨è‚¡åˆ© (Stock Dividend)
- é™¤æ¬Šæ¯äº¤æ˜“æ—¥
- ç›ˆé¤˜ç™¼æ”¾ç‡ (Payout Ratio)

**æ‡‰ç”¨**: è¨ˆç®—çœŸå¯¦æ®–åˆ©ç‡ã€å›æ¸¬é™¤æ¬Šæ¯è¡Œæƒ…ç­–ç•¥

---

### 5. è¡ç”Ÿæ€§å•†å“äº¤æ˜“ (Derivatives) ğŸ“Š åŒ¯æèˆ‡æŠ•æ©Ÿ
**æŠ•è³‡åƒ¹å€¼**: é‡å°é›»å­æ¥­/é€²å‡ºå£æ¥­ï¼Œæª¢è¦–å…¬å¸æ˜¯å¦éåº¦æŠ•æ©Ÿã€‚

**MOPS è·¯å¾‘**: `è²¡å‹™é‡é»å°ˆå€` æˆ– `é‡è¦æœƒè¨ˆæ”¿ç­–`

**é—œéµæ¬„ä½**:
- æœªåˆ°æœŸå¥‘ç´„é‡‘é¡
- å…¬å¹³åƒ¹å€¼è©•ä¼°æç›Š

**æ‡‰ç”¨**: é è­¦ã€Œæœªå¯¦ç¾æå¤±ã€éå¤§çš„å…¬å¸

---

### 6. è³‡æœ¬å½¢æˆ (Capital Structure) ğŸ“ˆ è‚¡æœ¬è†¨è„¹
**æŠ•è³‡åƒ¹å€¼**: æŒæ¡ç§å‹Ÿã€å¢è³‡ã€å¯è½‰å‚µç­‰å½±éŸ¿è‚¡åƒ¹çš„äº‹ä»¶ã€‚

**MOPS è·¯å¾‘**: `åŸºæœ¬è³‡æ–™` æˆ– `é‡å¤§è¨Šæ¯` ä¸­çš„å¢è³‡/æ¸›è³‡å…¬å‘Š

**é—œéµæ¬„ä½**:
- ç§å‹Ÿ (Private Placement) - èªè³¼è€…ã€åƒ¹æ ¼
- ç¾é‡‘å¢è³‡ (SPO) - çŸ­æœŸè‚¡åƒ¹å£“åŠ›
- å¯è½‰å‚µ (CB) - ç‰¹å®šèµ°å‹¢æ¨¡å¼

**æ‡‰ç”¨**: è­˜åˆ¥è‚¡æœ¬ç¨€é‡‹é¢¨éšª

---

## Acceptance Criteria

### Functional Requirements
- [ ] æ¯å€‹è³‡æ–™é¡å‹éƒ½æœ‰ç¨ç«‹çš„çˆ¬èŸ²æœå‹™
- [ ] æ¯å€‹è³‡æ–™é¡å‹éƒ½æœ‰å°æ‡‰çš„ REST API ç«¯é»
- [ ] æ”¯æ´æŒ‰è‚¡ç¥¨ä»£è™Ÿ + å¹´åº¦/æœˆä»½æŸ¥è©¢
- [ ] è¿”å›çµæ§‹åŒ–çš„ JSON è³‡æ–™
- [ ] å¯¦ä½œè³‡æ–™åº«å¿«å–æ©Ÿåˆ¶ï¼ˆèˆ‡ç¾æœ‰ financial æœå‹™ä¸€è‡´ï¼‰

### Non-Functional Requirements
- [ ] çˆ¬èŸ²åŠ å…¥åˆç†çš„ rate limiting (time.sleep)
- [ ] è™•ç† MOPS çš„ Big5 ç·¨ç¢¼
- [ ] éŒ¯èª¤è™•ç†ï¼šç¶²è·¯è¶…æ™‚ã€é é¢ä¸å­˜åœ¨ã€æ ¼å¼è®Šæ›´
- [ ] å®Œæ•´çš„å–®å…ƒæ¸¬è©¦å’Œæ•´åˆæ¸¬è©¦
- [ ] API æ–‡æª” (OpenAPI/Swagger)

### API Design
æ¯å€‹ç«¯é»æ‡‰éµå¾ªç¾æœ‰ API é¢¨æ ¼ï¼š
```
GET /revenue/{stock_id}/monthly?year={year}&month={month}
GET /risk/{stock_id}/endorsements?year={year}
GET /risk/{stock_id}/share-pledging?date={date}
GET /dividend/{stock_id}?year={year}
GET /risk/{stock_id}/derivatives?year={year}&quarter={quarter}
GET /capital/{stock_id}?year={year}
```

---

## Dependencies

### Internal
- ç¾æœ‰ `MOPSClient` é¡åˆ¥ (app/services/mops_client.py)
- ç¾æœ‰è³‡æ–™åº«å¿«å–æ¶æ§‹ (app/db/)
- ç¾æœ‰ Pydantic schemas æ¨¡å¼

### External
- `pandas` - HTML è¡¨æ ¼è§£æ (`pd.read_html()`)
- `httpx` - HTTP è«‹æ±‚
- `beautifulsoup4` - é¸æ“‡æ€§ä½¿ç”¨ï¼Œè™•ç†è¤‡é›œ HTML

### Technical Notes
- MOPS URL é€šå¸¸å¸¶æœ‰ `form_id` (å¦‚ `t05st10_ifrs`)
- å¾ˆå¤š MOPS èˆŠé é¢ä½¿ç”¨ **Big5** ç·¨ç¢¼
- MOPS å°é«˜é »çˆ¬å–æ•æ„Ÿï¼Œéœ€è¦ rate limiting
